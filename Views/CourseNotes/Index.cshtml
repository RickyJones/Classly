@using Classly.Models.Courses
@using Classly.Services.Data
@model List<CourseNote>
@inject IUserService userService

@{
    User student = null;
    User teacher = null;
    if (Model != null && Model.Any())
    {
        student = await userService.GetUser(Model.FirstOrDefault().StudentId);
        teacher = await userService.GetUser(Model.FirstOrDefault().TutorId);
    }
}

<style>
    .timeline {
        position: relative;
        margin: 20px 10px;
        padding-left: 0px; /* space for markers */
        border-left: 5px solid orange; /* vertical line */
    }

    .timeline-item {
        position: relative;
        margin-bottom: 50px;
    }

    .timeline-marker {
        position: absolute;
        left: -14px; /* centers marker on line */
        top: 0;
        width: 20px;
        height: 20px;
        background-color: orange; /* blue blob */
        border-radius: 50%;
        border: 2px solid white;
        box-shadow: 0 0 0 2px orange;
    }

    .timeline-content {
        padding: 1px 25px;
    }

    .timeline-title {
        margin: 0;
        font-size: 1.1em;
        font-weight: bold;
    }

    .timeline-date {
        margin: 0;
        font-size: 0.9em;
        color: #666;
    }

</style>

<h1>Course Notes</h1>

@if(Model == null){
<form method="post">
    <label>Please select a student</label>
    <select name="studentId" class="form-select">
        @foreach (var student in await userService.GetStudentsAsync())
        {
            <option value="@student.Id">@student.Name (@student.Email)</option>
        }
    </select>
    <br/>
    <button class="btn btn-primary" type="submit">Get Student Notes</button>
</form>
}
else {
    
    <button class="btn btn-primary" onclick="location.href='@Url.Action("UploadStudyNotes", new {studentId = ViewBag.StudentId})'">New Session</button>
    <h3>Sessions with @student?.Name</h3>
<div class="timeline">
    @foreach (var note in Model)
    {
            <div class="timeline-item">
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                    <h3 class="timeline-title">@note.Difficulty</h3>
                    <p class="timeline-date">@note.CreatedAt</p>
                    <p>Teacher: @teacher?.Name</p>
                    <button onclick="location.href='@Url.Action("ViewNote", new { noteId = note.Id })'">View</button>
                </div>
            </div>
    }
</div>
}

@* Add this in for timeline UI *@


